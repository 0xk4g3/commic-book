(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[526],{7211:function(e,t,a){Promise.resolve().then(a.bind(a,6845))},6845:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var s=a(7437),n=a(2265),r=a(9376),l=a(2660),c=a(3229),i=a(2735),o=a(6949),d=a(3375),x=a(7635),h=a.n(x),m=a(9295);function g(){let e=(0,r.useRouter)(),[t,a]=(0,n.useState)(null),[x,g]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let t=localStorage.getItem("current-comic");t?a(JSON.parse(t)):e.push("/")},[e]);let p=async()=>{if(!t)return;let e=new d.ZP("p","mm","a4"),a=e.internal.pageSize.getWidth();e.internal.pageSize.getHeight(),e.setFontSize(24),e.text(t.title,a/2,40,{align:"center"}),e.setFontSize(18),e.text(t.titleAr,a/2,60,{align:"center"}),e.setFontSize(12),e.text("Setting: ".concat(t.setting.substring(0,150),"..."),20,80),e.text("Characters: ".concat(t.characters.map(e=>e.name).join(", ")),20,90);for(let s=0;s<t.panels.length;s++){e.addPage();let n=t.panels[s];try{let t=await fetch(n.imageUrl),s=await t.blob(),r=await new Promise(e=>{let t=new FileReader;t.onloadend=()=>e(t.result),t.readAsDataURL(s)}),l=a-40,c=3*l/4;e.addImage(r,"PNG",20,20,l,c),e.setFontSize(10),e.text("Panel ".concat(n.number,": ").concat(n.scene),20,c+30),e.text("Tradition: ".concat(n.tradition),20,c+40)}catch(t){console.error("Error adding panel ".concat(s+1,":"),t),e.setFontSize(12),e.text("Error loading panel ".concat(s+1),20,100)}}e.save("".concat(t.title.replace(/\s+/g,"_"),".pdf"))},u=async()=>{if(!t)return;let e=new(h());for(let a of t.panels)try{let t=a.imageUrl.split(",")[1],s=atob(t),n=new ArrayBuffer(s.length),r=new Uint8Array(n);for(let e=0;e<s.length;e++)r[e]=s.charCodeAt(e);e.file("panel_".concat(a.number,".png"),r)}catch(e){console.error("Error adding panel ".concat(a.number," to ZIP:"),e)}let a=await e.generateAsync({type:"blob"}),s=URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download="".concat(t.title.replace(/\s+/g,"_"),".zip"),n.click(),URL.revokeObjectURL(s)},b=e=>{let t=document.createElement("a");t.href=e.imageUrl,t.download="panel_".concat(e.number,".png"),t.click()};return t?(0,s.jsxs)("div",{className:"min-h-screen",children:[(0,s.jsx)(m.Z,{currentPage:"viewer"}),(0,s.jsxs)("main",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)("button",{onClick:()=>e.push("/generator?value="+t.valueId),className:"mb-4 flex items-center space-x-2 text-gray-600 transition-smooth hover:text-gray-800",children:[(0,s.jsx)(l.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"Back to Generator"})]}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"mb-2 text-4xl font-bold text-gray-800",children:t.title}),(0,s.jsx)("p",{className:"mb-4 font-amiri text-2xl text-gray-600",children:t.titleAr}),(0,s.jsx)("p",{className:"mx-auto max-w-2xl text-gray-600",children:t.setting})]})]}),(0,s.jsxs)("div",{className:"mb-8 flex flex-wrap justify-center gap-4",children:[(0,s.jsxs)("button",{onClick:()=>{if(!t)return;let e=JSON.parse(localStorage.getItem("saved-comics")||"[]");e.find(e=>e.id===t.id)||(e.push(t),localStorage.setItem("saved-comics",JSON.stringify(e)),g(!0))},disabled:x,className:"flex items-center space-x-2 rounded-lg px-6 py-3 font-bold text-white shadow-lg transition-smooth hover:scale-105 ".concat(x?"bg-green-600":"bg-gradient-to-r from-desert-gold to-winter-blue"),children:[(0,s.jsx)(c.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:x?"Saved!":"Save to Library"})]}),(0,s.jsxs)("button",{onClick:p,className:"flex items-center space-x-2 rounded-lg bg-red-600 px-6 py-3 font-bold text-white shadow-lg transition-smooth hover:scale-105 hover:bg-red-700",children:[(0,s.jsx)(i.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"Download PDF"})]}),(0,s.jsxs)("button",{onClick:u,className:"flex items-center space-x-2 rounded-lg bg-blue-600 px-6 py-3 font-bold text-white shadow-lg transition-smooth hover:scale-105 hover:bg-blue-700",children:[(0,s.jsx)(i.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"Download ZIP"})]}),(0,s.jsxs)("button",{onClick:()=>e.push("/library"),className:"flex items-center space-x-2 rounded-lg bg-purple-600 px-6 py-3 font-bold text-white shadow-lg transition-smooth hover:scale-105 hover:bg-purple-700",children:[(0,s.jsx)(o.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{children:"View Library"})]})]}),(0,s.jsx)("div",{className:"mx-auto max-w-4xl",children:(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:t.panels.map((e,t)=>(0,s.jsxs)("div",{className:"card-hover group overflow-hidden rounded-2xl bg-white p-4 shadow-lg",style:{animationDelay:"".concat(.1*t,"s")},children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("img",{src:e.imageUrl,alt:"Panel ".concat(e.number),className:"h-auto w-full rounded-lg"}),(0,s.jsx)("button",{onClick:()=>b(e),className:"absolute right-2 top-2 rounded-lg bg-black/50 p-2 text-white opacity-0 transition-smooth group-hover:opacity-100",children:(0,s.jsx)(i.Z,{className:"h-5 w-5"})})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("p",{className:"mb-1 font-bold text-gray-800",children:["Panel ",e.number]}),(0,s.jsx)("p",{className:"mb-2 text-sm text-gray-600",children:e.scene}),(0,s.jsxs)("p",{className:"text-xs text-gray-500",children:["Tradition: ",e.tradition]})]})]},e.number))})}),(0,s.jsxs)("div",{className:"mx-auto mt-12 max-w-4xl rounded-2xl bg-white p-6 shadow-lg",children:[(0,s.jsx)("h2",{className:"mb-4 text-2xl font-bold text-gray-800",children:"Characters"}),(0,s.jsx)("div",{className:"space-y-4",children:t.characters.map((e,t)=>(0,s.jsxs)("div",{className:"border-l-4 border-desert-gold pl-4",children:[(0,s.jsx)("h3",{className:"font-bold text-gray-800",children:e.name}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]},t))})]})]})]}):(0,s.jsxs)("div",{className:"min-h-screen",children:[(0,s.jsx)(m.Z,{}),(0,s.jsx)("main",{className:"container mx-auto px-4 py-8",children:(0,s.jsx)("p",{children:"Loading..."})})]})}},9295:function(e,t,a){"use strict";a.d(t,{Z:function(){return i}});var s=a(7437),n=a(7648),r=a(9376),l=a(9637),c=a(6949);function i(e){let{currentPage:t}=e,a=(0,r.usePathname)(),i=t||a;return(0,s.jsx)("header",{className:"sticky top-0 z-50 border-b border-white/20 bg-white/80 backdrop-blur-md",children:(0,s.jsxs)("nav",{className:"container mx-auto flex items-center justify-between px-4 py-4",children:[(0,s.jsxs)(n.default,{href:"/",className:"flex items-center space-x-2 text-2xl font-bold gradient-text transition-smooth hover:scale-105",children:[(0,s.jsx)("span",{children:"\uD83E\uDD85"}),(0,s.jsx)("span",{children:"UAE Winter Tales"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)(n.default,{href:"/",className:"flex items-center space-x-2 rounded-lg px-4 py-2 transition-smooth hover:bg-desert-light ".concat("/"===i||"home"===i?"bg-desert-light text-desert-dark":"text-gray-600"),children:[(0,s.jsx)(l.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Home"})]}),(0,s.jsxs)(n.default,{href:"/library",className:"flex items-center space-x-2 rounded-lg px-4 py-2 transition-smooth hover:bg-desert-light ".concat("/library"===i||"library"===i?"bg-desert-light text-desert-dark":"text-gray-600"),children:[(0,s.jsx)(c.Z,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"Library"})]})]})]})})}}},function(e){e.O(0,[505,884,894,971,117,744],function(){return e(e.s=7211)}),_N_E=e.O()}]);